---
title: "p8105_hw2_zj2358"
author: "Zhezheng Jin"
date: "2023-10-02"
output: github_document
---

## Problem 1

```{r setup, include=FALSE}
library(tidyverse)
library(readxl)
options(warn = -1)
```

data clean of pols_month

```{r}
pols_month = read_csv(file = "pols-month.csv") %>%
  janitor::clean_names() %>%
  separate(mon, into = c("year", "month", "day"), sep = "-") %>%
  mutate(month = month.name[as.integer(month)],
         president = ifelse(prez_dem == 1, "dem", ifelse(prez_gop == 1, "gop", NA))) %>%
  select(-prez_dem, -prez_gop, -day)

pols_month
```

data clean of snp

```{r}
snp = read_csv(file = "snp.csv") %>%
  janitor::clean_names() %>%
  separate(date, into = c("month", "day", "year"), sep = "/") %>%
  mutate(year = ifelse(year >= 0 & year <= 15, paste("20", year, sep = ""), paste("19", year, sep = ""))) %>%
  mutate(month = month.name[as.integer(month)]) %>%
  arrange(year, month) %>%
  select(year, month, day, everything()) %>%
  select(-day)

snp
```

tidy data unemployment 

```{r}
unemployment = read_csv(file = "unemployment.csv") %>%
  pivot_longer(cols = -Year, names_to = "month", values_to = "unemployment") %>%
  mutate(month = tolower(month)) %>%
  mutate(month = case_when(
    month %in% c("jan", "january") ~ "January",
    month %in% c("feb", "february") ~ "February",
    month %in% c("mar", "march") ~ "March",
    month %in% c("apr", "april") ~ "April",
    month %in% c("may") ~ "May",
    month %in% c("jun", "june") ~ "June",
    month %in% c("jul", "july") ~ "July",
    month %in% c("aug", "august") ~ "August",
    month %in% c("sep", "september") ~ "September",
    month %in% c("oct", "october") ~ "October",
    month %in% c("nov", "november") ~ "November",
    month %in% c("dec", "december") ~ "December",
    TRUE ~ NA_character_
  )) %>%
  select(year=Year, month, unemployment, everything())

unemployment
```

merge datasets

```{r}
merged_data <- inner_join(pols_month, snp, by = c("year", "month"))
unemployment$year <- as.character(unemployment$year)
final_data <- inner_join(merged_data, unemployment, by = c("year", "month"))

final_data
```

The dataset `final_data` comprises three primary sources of data, each contributing unique insights. Firstly, `pols_month` offers political data, containing information about the monthly representation of both Republican and Democratic officials at the levels of governor, senator, and representative. Secondly, `snp` contributes financial data, providing monthly closing values for the S&P stock index, which is often used as a benchmark for stock market performance. Lastly, `unemployment` presents economic data in a wide format, featuring monthly unemployment rates. The merged `final_data` dataset seamlessly combines these sources, resulting in a comprehensive dataset with `r nrow(final_data)` rows and `r ncol(final_data)` columns. The dataset spans from `r  range(pull(final_data, year), na.rm = TRUE)`, encompassing a wide range of historical information. Key variables in the dataset include `r colnames(final_data)`.

## Problem 2

Read and Clean: MTW 

```{r MTW}
mtw_df = read_excel(
  "202207 Trash Wheel Collection Data.xlsx",
  cell_cols("A:N"),
  sheet = "Mr. Trash Wheel") %>% 
  janitor::clean_names() %>% 
  drop_na(dumpster) %>% 
  mutate(homes_powered_N = weight_tons*500/30,
         wheel_type = c("MT")) %>% 
  relocate(wheel_type,dumpster,year,month) 
mtw_df
```

Read and Clean: PTW

```{r PTW}
ptw_df = read_excel(
  "202207 Trash Wheel Collection Data.xlsx",
  cell_cols("A:M"),
  sheet = "Professor Trash Wheel") %>% 
  janitor::clean_names() %>% 
  drop_na(dumpster) %>% 
  mutate(homes_powered_N = weight_tons*500/30,
         wheel_type = c("PT")) %>% 
  relocate(wheel_type,dumpster,year,month) 
ptw_df
```

Read and Clean: GTW

```{r GTW}
gtw_df = read_excel(
  "202207 Trash Wheel Collection Data.xlsx",
  cell_cols("A:K"),
  sheet = "Gwynnda Trash Wheel") %>% 
  janitor::clean_names() %>% 
  drop_na(dumpster) %>% 
  mutate(homes_powered_N = weight_tons*500/30,
         wheel_type = c("GT")) %>% 
  relocate(wheel_type,dumpster,year,month) 
gtw_df
```

Combine them together

```{r combine}
mtw_df$year <- as.double(mtw_df$year)
combined_df <- bind_rows(mtw_df, ptw_df, gtw_df)
combined_df
```

The dataset `combined_df` comprises data from three trash-collecting entities: Mr. Trash Wheel, Professor Trash Wheel, and Gwynnda Trash Wheel. In total, there are `r nrow(combined_df)` observations in the combined dataset, representing various trash collection events. Key variables include trash_weight, which denotes the weight of trash collected during each event, and homes_powered, representing the approximate number of homes powered by the collected trash. The total weight of trash collected by Professor Trash Wheel is `r sum(ptw_df$weight_tons)` tons, and the total number of cigarette butts collected by Gwynnda in July 2021 is `r format(sum(gtw_df$cigarette_butts[3:7]), scientific = F)`.

## Problem 3





